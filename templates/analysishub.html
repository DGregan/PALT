{% include 'head-static.html' %}
<title>Analysis Hub - PALT</title>
<body>

{% include 'nav-static.html' %}

<main class="cd-main-content">
    <div class="container">
        <br><br>
        <div class="row">
                <div class="col-lg-12">
                    <h1>Analysis Hub</h1>
                    <hr>
                    <p>
                        The Analysis Hub is where all of the captured network traffic from chosen capture device will be displayed here.
                    </p>
                    <p>
                            <strong>Chosen Captured Device:{{ capture_device | safe }}</strong>
                    </p>
                    <p>
                        Stuff goes here
                    </p>
                </div> <!-- col-lg-12 -->
        </div><!-- row -->

        <br>

        <div class="row">
            <div class="col-lg-12">
                <h1><i class="fa fa-newspaper-o"></i> Packet Capture Summary</h1>
                <hr>
                <p>This area displays a summary of the capture packets from the chosen network device.</p>

                <br>
                <br>
                <div class="list-group">
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Time of Capture</h4>
                        <p class="list-group-item-text">The Time of capture refers to the second a packet was captured
                        from the network device. Displayed in the format (YYYY-MM-DD HH:MM:SS)
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination IP Address</h4>
                        <p class="list-group-item-text">
                            <strong>Source IP Address</strong>: P
                            <br>
                            <strong>Destination IP Address</strong>:
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Protocol</h4>
                        <p class="list-group-item-text">The protocol column of the Packet Capture Summary refers to the
                        Transport Layer Protocol used to assist in getting the packet across a network
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination Ports</h4>
                        <p class="list-group-item-text">
                            <strong>Source Port</strong>: Port from where the network traffic was sent
                            <br>
                            <strong>Destination Port</strong>: Port that will receive the network traffic
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination MAC Address</h4>
                        <p class="list-group-item-text">MAC (Media Access Control) address is a unique 'physical'
                            hardware address (48 bits in length)</p>
                    </a>
                </div><!-- list-groip -->
                <hr>
                <br>
            </div><!-- col -->
        </div><!-- row -->

        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-bar-chart-o"></i> Summary Table</h2>
                <hr>
                <div class="table-responsive" style="height: 400px;">
                    {{ pandas_web | safe }}
                </div><!-- Table -->
                <hr>
            </div> <!-- col-lg-12 -->
        </div><!-- row -->

        <hr>

        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-download"></i> Download Summary</h2>
                <hr>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default">Download Summary (CSV)</button>
                    <button type="button" class="btn btn-default">Download Summary (Excel)</button>
                </div><!-- btn group -->
            </div> <!-- col-lg-12 -->
        </div><!-- row -->


        <br><br>

        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-object-group"></i> Packet Capture Contents</h2>
                <hr>

                <br>
                    {% if eth_info != [] %}
                    <!--       eth ACCORDION BUTTON         -->
                        <button class="accordion">Captured Ethernet Header Information</button>
                        <div class="panel">
                        <h4>--Ethernet--</h4>
                        <p>Ethernet is blah blah blah</p>

                            {% for dict_item in eth_info %}
                                <h3>{{ loop.index }}</h3>
                                <br>
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">
                                        {% if key == 'Protocol' %}
                                            <br>
                                            <p>{{ value | safe }}</p>
                                            <br>

                                            <p>PROTOCOL TEST</p>

                                        {% elif key == 'Destination MAC Address' %}
                                            <h5>What is the Destination Address?</h5>
                                            <hr>
                                            <p>A destination address is...</p>
                                            <br>
                                            <p>Packet's Destination Address: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Source MAC Address' %}
                                            <h5>What is the Source Address?</h5>
                                            <p>A source address is...</p>
                                            <br>
                                            <p>Packet's Source Address: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Type Code' %}
                                            <h5>What is the Type</h5>
                                            <p>A Type is...</p>
                                            <br>
                                            <p>Packet's Type: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Type Result'%}
                                            <p>{{ key | safe }}: {{ value | safe }}</p>

                                        {% else %}
                                            <p>Data not found</p>

                                        {% endif %}
                                    </div>
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- End ETH -->

                    {% if ip_info != [] %}
                    <!--       IP ACCORDION BUTTON         -->
                        <button class="accordion">Captured IP Header Information</button>
                        <div class="panel">
                        <br>
                        <h4>IP Information</h4>
                        <hr>
                        <p>IP is the ...</p>
                            {% for dict_item in ip_info %}
                                {{ loop.index }}
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">
                                     {% if key == 'Version' %}
                                         <h5>What is ....</h5>
                                         <p>A thing is...</p>
                                        <br>
                                         <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Header Length' %}
                                        <h5>What is the ...</h5>
                                        <p>A Type is...</p>
                                        <br>
                                        <p>Packet's Type: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Type of Service' %}
                                        <h5>What is the Type</h5>
                                        <p>A Type is...</p>
                                        <br>
                                        <p>Packet's Type: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Total Length' %}
                                        <h5>What is the ...</h5>
                                        <p>A Type is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Identification' %}
                                        <h5>What is the ...</h5>
                                        <p>A Type is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Flags' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Fragment Offset' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Time To Live' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Protocol Number' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Protocol Number Result' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Header Checksum' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Source Address' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Destination Address' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Checksum Status' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     <!-- IPv6 Data Display -->
                                     {% elif key == 'Traffic Class' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Traffic Class ECN' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Traffic Class DSCP' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Flow Label' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Payload Length' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Next Header' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Hop Limit' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Source Address' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% elif key == 'Destination Address' %}
                                        <h5>What is the ...</h5>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: {{ value | safe }}</p>
                                        <br>

                                     {% else %}
                                         <p>Error</p>
                                         {{ key | safe }}:{{ value | safe }}

                                    {% endif %}
                                    </div>
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- end IP -->

                    <!--       TCP ACCORDION BUTTON         -->
                    {% if tcp_info != [] %}
                        <button class="accordion">Captured TCP Header Information</button>
                        <div class="panel">
                        <br>
                            {% for dict_item in tcp_info %}
                                {{ loop.index }}
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">
                                        {% if key == 'Source Port' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Destination Port' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>
                                        {% elif key == 'Destination Port' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Sequence Number' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Acknowledgment Number' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Reserve' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Flags' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>


                                        {% elif key == 'Window Size' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Checksum' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Checksum Status' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% elif key == 'Urgent Pointer' %}
                                                <h5>What is the ...</h5>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...: {{ value | safe }}</p>
                                                <br>

                                        {% else %}
                                            <p>{{ key | safe }}: {{ value | safe }}</p>
                                            <br>
                                        {% endif %}
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- end TCP -->

                    {% if udp_info != [] %}
                        <!--        UDP ACCORDION BUTTON         -->
                        <button class="accordion">Captured UDP Header Information</button>
                        <div class="panel">
                            {% for dict_item in udp_info %}
                                    {{ loop.index }}
                                    {% for key, value in dict_item.items() %}
                                        <button class="inner-accordion">{{ key | safe }}</button>
                                        <div class="inner-panel">
                                        {% if key == 'Source Port' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Dest. Port' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Length' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Checksum' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Checksum Status' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% elif key == 'Protocol' %}
                                            <h5>What is the ...</h5>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...: {{ value | safe }}</p>
                                            <br>

                                        {% else %}
                                            <p> data error</p>
                                        {% endif %}
                                        </div>
                                    {% endfor %}
                                    <br>
                                {% endfor %}
                        </div><!-- inner panel -->
                    {% endif %}
                </div><!-- panel-->
            </div><!-- col-lg-6 -->
        </div><!-- row -->
        <br>
    </div><!-- container -->
</main> <!-- cd-main-content -->
{% include 'footer.html' %}

{% include 'js-static.html' %}
</body>
</html>


<script>
    var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function(){
        /* Toggle between adding and removing the "active" class,
        to highlight the button that controls the panel */
        this.classList.toggle("active");

        /* Toggle between hiding and showing the active panel */
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
}
</script>

<script>
    var acc = document.getElementsByClassName("inner-accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function(){
        /* Toggle between adding and removing the "active" class,
        to highlight the button that controls the panel */
        this.classList.toggle("active");

        /* Toggle between hiding and showing the active panel */
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
}
</script>

<script>
$(document).ready(function(){
    $("#myBtn").click(function(){
        $("#myModal").modal();
    });
});
</script>
<script>

    function download() {
        alert("BS");
        var jsString = $('pandas_web_base');

        $.ajax({
            url: '/analysishub/',
            data:jsString,
            success: function (data) {
                var FileSaver = require('file-saver');
                var blob = new Blob([data], {type: "text/plain;charset=utf-8"});
                FileSaver.saveAs(blob, data)

            }
        })
    }


</script>

<!--
<script>
$(document).ready(function () {
        $.ajax({
            url: '/interfaces',
            type: 'POST',
            data: 'pandas_web',
            success: function (response) {
            alert('Packet Analysis beginning');
            console.log(pandas_web);
            },
            error: function (error) {
                console.log(error);
            }
        });
    });
</script>
-->