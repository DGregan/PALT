{% include 'head-static.html' %}
<title xmlns="http://www.w3.org/1999/html">Analysis Hub - PALT</title>

<body>

{% include 'nav-static.html' %}


<main class="cd-main-content">
    <div class="container">
        <br><br>
        <div class="row">
                <div class="col-lg-12">
                    <h1><i class="fa fa-cogs"></i> Analysis Hub</h1>
                    <hr>
                    <p>
                        The Analysis Hub is where all of the captured network traffic from chosen capture device will be displayed.
                    </p>
                    <br>
                    <p>
                           <strong>Chosen Captured Device:</strong> {{ dev | safe }}
                    </p>
                </div> <!-- col-lg-12 -->
        </div><!-- row -->

        <br>
        <!-- Packet Summary Details -->
        <div class="row">
            <div class="col-lg-12">
                <h1><i class="fa fa-newspaper-o"></i> Packet Capture Summary Details</h1>
                <hr>
                <p>This area displays a summary of the capture packets from the chosen network device:</p>

                <br>
                <br>
                <div class="list-group">
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Time of Capture</h4>
                        <p class="list-group-item-text">
                            The Time of capture refers to the second a packet was captured
                            from the network device. Displayed in the format (YYYY-MM-DD HH:MM:SS)
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination IP Address</h4>
                        <p class="list-group-item-text">
                            An IP Address is an identifier assigned to each device connected to
                            a network in order to locate it.
                            <br>
                            <strong>Source IP Address</strong>: The Source IP Address is the 'home address' of the device
                            on the network.
                            <br>
                            <strong>Destination IP Address</strong>: The Destination IP Address is the address where the
                            network data is to be sent to.
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Protocol</h4>
                        <p class="list-group-item-text">
                            The protocol column of the Packet Capture Summary refers to the
                            Transport Layer Protocol used to assist in getting the packet across a network.
                            <br>
                            There are two possible Transport Protocols:
                            <br>
                            <strong>TCP</strong> (Transmission Control Protocol):
                             Is a protocol that provides reliable, ordered, error checked delivery of data through streams between
                            applications running on hosts/devices on an IP network.
                            <br>
                            <strong>UDP</strong> (User Datagram Protocol):
                            This protocol
	                        uses a simple connectionless transmission model for streaming of data.
                            Provides checksum for data integirty, port numbers
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination Ports</h4>
                        <p class="list-group-item-text">

                            <strong>Source Port</strong>: Port from where the network traffic was sent
                            <br>
                            <strong>Destination Port</strong>: Port that will receive the network traffic
                        </p>
                    </a>
                    <a href="#" class="list-group-item">
                        <h4 class="list-group-item-heading">Source/Destination MAC Address</h4>
                        <p class="list-group-item-text">
                            Network cards each have a unique 'physical' MAC address.
                            Packets that are sent on the ethernet are always coming from a source MAC address and sent to
                            a destination MAC address. If a network adapter is receiving a packet, it is comparing the packet’s
                            destination MAC address to the adapter’s own MAC address.
                            If the addresses match, the packet is processed, otherwise it is discarded.
                        </p>
                    </a>
                </div><!-- list-groip -->
                <hr>
                <br>
            </div><!-- col -->
        </div><!-- row -->

        <!-- Summary Table -->
        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-bar-chart-o"></i> Summary Table</h2>
                <hr>
                <div class="table-responsive" style="height: 400px;">
                    {{ pandas_web | safe }}
                </div><!-- Table -->
                <hr>
            </div> <!-- col-lg-12 -->
        </div><!-- row -->

        <hr>

        <!-- Download Summary -->
        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-download"></i> Download Summary</h2>
                <hr>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default">Download Summary (CSV)</button>
                </div><!-- btn group -->
            </div> <!-- col-lg-12 -->
        </div><!-- row -->


        <br><br>

        <!-- Packet Capture Results -->
        <div class="row">
            <div class="col-lg-12">
                <h2><i class="fa fa-object-group"></i> Packet Capture Results</h2>
                <hr>

                <br>
                    {% if eth_info != [] %}
                    <!--       eth ACCORDION BUTTON         -->
                        <button class="accordion">Captured Ethernet Header Information</button>
                        <div class="panel">
                        <h4>Ethernet Header</h4>
                        <hr>
                        <p>Ethernet is blah blah blah</p>

                            {% for dict_item in eth_info %}
                                <h3>{{ loop.index }}</h3>
                                <br>
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">
                                        {% if key == 'Protocol' %}
                                            <br>
                                            <p>{{ value | safe }}</p>
                                            <br>

                                            <p>PROTOCOL TEST</p>

                                        {% elif key == 'Destination MAC Address' %}
                                            <br>
                                            <h3>What is the Destination MAC Address?</h3>
                                            <hr>
                                            <p>A MAC Address is a physical unique</p>
                                            <br>
                                            <p>Packet's Destination MAC Address:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Source MAC Address' %}
                                            <br>
                                            <h3>What is the Source Address?</h3>
                                            <hr>
                                            <p>A source address is...</p>
                                            <br>
                                            <p>Packet's Source MAC Address:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Type Code' %}
                                            <br>
                                            <h3>What is the Type Code?</h3>
                                            <hr>
                                            <p>
                                                The Ethernet Type Code is a simple hexidecimal code used to indicate what
                                                kind of data is held within the packet. These codes correspond with the protocol being
                                                used for the remainder of the packet. (Ex. Address Resolution Protocol, Internet Protocol, etc..)
                                            </p>
                                            <br>
                                            <p>Packet's Type Code:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'CRC' %}
                                            <br>
                                            <h3>What is the CRC</h3>
                                            <p>A Type is...</p>
                                            <br>
                                            <p>Packet's Type:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% else %}
                                            <br>
                                            <p>Data Not Found</p>
                                            <br>

                                        {% endif %}
                                    </div>
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- End ETH -->

                    {% if ip_info != [] %}
                    <!--       IP ACCORDION BUTTON         -->
                        <button class="accordion">Captured IP Header Information</button>
                        <div class="panel">
                        <br>
                        <h4>IP Information</h4>
                        <hr>
                        <p>
                            The Internet Protocol (AKA IP) is the method by which data is sent from one computer to
                            another over the Internet.The IP Header points out the source and destination of the packet,
                            while the actual data (the packet minus all headers, descriptive meta-data) being
                            transferred over the Internet is called the Payload.

                        </p>
                        <br>
                        <p>
                            For further information about what each field found within a IP Header, select one of the options below.
                        </p>
                        <br>
                            {% for dict_item in ip_info %}
                                {{ loop.index }}
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">

                                     {% if key == 'Version' %}
                                         <h3>What is the Version field?</h3>
                                         <p>
                                             The version field describes what version of the Internet Protocol (IP) is being
                                            used for this packet.
                                         </p>
                                        <br>
                                         <p>Packet's Internet Protocol Version:  <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Header Length' %}
                                        <h3>What is the Header Length field?</h3>
                                        <p>
                                           The Header Length is the total length of the IP Header in the packet.
                                        </p>
                                        <br>
                                        <p>Packet's Header Length:  <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Type of Service' %}
                                        <h3>What is the Type field?</h3>
                                        <p>A Type is...</p>
                                        <br>
                                        <p>Packet's Type:  <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Total Length' %}
                                        <h3>What is the Total Length field?</h3>
                                        <p>
                                            The Total Length of the IP Header is the value of the entire IP Packet which
                                            includes the IP Header and the IP Payload. The IP Payload is only the actual
                                            data being received by the destination system.
                                        </p>
                                        <br>
                                        <p>Packet's Total Length:  <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Identification' %}
                                        <h3>What is the Identification field?</h3>
                                        <p>
                                            Whenever a datagram (used when communication is unreliable) is assembled it
                                            is provided with a unique ID number. If this packet happens to become fragmented
                                            (splits into smaller pieces), this ID is ued to reassemble the datagram when it
                                            is received at it's destination.
                                        </p>
                                        <br>
                                        <p>Packet's Identification Number:  <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Flags' %}
                                        <h3>What is the ...</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Fragment Offset' %}
                                        <h3>What is the ..field?</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p>Packet's ...: <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Time To Live' %}
                                        <h3>What is the Time To Live field?</h3>
                                        <p>
                                            The Time To Live is the amount of time a datagram is allowed to exist on the network.
                                            Usually set to 15/30. The time is reduced by one every time the datagram passes
                                            through a host / router. If the TTL reaches 0 before the datagram makes it to it's destination,
                                            it is discarded and sends message back to originator that it can resend.
                                        </p>
                                        <br>
                                        <p>Packet's Time To Live: <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Protocol Number' %}
                                        <h3>What is the Protocol Number field?</h3>
                                        <p>
                                            The Protocol number is a code representing the transport protocol of the segment assigned to
                                            IP layer. It identifies the next upper level protocol (TCP, UDP) where the data payload is being handed to.
                                        </p>
                                        <br>
                                        <p> Packet's Protocol Number:   <strong>{{ value | safe }}</strong></p>
                                        <br>


                                     {% elif key == 'Header Checksum' %}
                                        <h3>What is the Header Checksum field?</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's Header Checksum:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Source Address' %}
                                        <h3>What is the Source Address field?</h3>
                                        <p>
                                            The Source Address is the IP address that states the source of the packet.
                                        </p>
                                        <br>
                                        <p> Packet's Source Address:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Destination Address' %}
                                        <h3>What is the Destination Address field?</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's Destination Address:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Checksum Status' %}
                                        <h3>What is the ...</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's ...:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Traffic Class' %}
                                        <h3>What is the ...</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's ...:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Traffic Class ECN' %}
                                        <h3>What is the ...</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's ...:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Traffic Class DSCP' %}
                                        <h3>What is the ...</h3>
                                        <p>A ... is...</p>
                                        <br>
                                        <p> Packet's ...:   <strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Flow Label' %}
                                        <h3>What is the Flow Label field?</h3>
                                        <p>

                                        </p>
                                        <br>
                                        <p> Packet's Flow Label:<strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Payload Length' %}
                                        <h3>What is the Payload Length field?</h3>
                                        <p>
                                            The Payload Length field specifies the size of the data payload following the IPv6 Header.
                                        </p>
                                        <br>
                                        <p> Packet's Payload Length:<strong>{{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Next Header' %}
                                        <h3>What is the Next Header field?</h3>
                                        <p>
                                            The Next Header field is used to the layer 4 transfer protocol which follows the IP header.
                                        </p>
                                        <br>
                                        <p> Packet's Next Header:<strong> {{ value | safe }}</strong></p>
                                        <br>

                                     {% elif key == 'Hop Limit' %}
                                        <h3>What is the Hop Limit field</h3>
                                        <p>
                                            The Hop Limit is the IPV6 version of Time To Live, found in a IPv4 Header.
                                            The Hop Limit is the amount of time a datagram is allowed to exist on the network.
                                            Each hop between network nodes / devices decrements the limit by 1 and when the hop reaches 0, packet is discarded.
                                        </p>
                                        <br>
                                        <p> Packet's Hop Limit:<strong> {{ value | safe }}</strong></p>

                                    {% else %}
                                        <br>
                                        <p>Data not Found</p>
                                        <br>
                                    {% endif %}
                                    </div>
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- end IP -->


                    <!--       TCP ACCORDION BUTTON         -->
                    {% if tcp_info != [] %}
                        <button class="accordion">Captured TCP Header Information</button>
                        <div class="panel">
                        <br>
                        <h4>TCP Information</h4>
                        <hr>
                        <p>
                           The Transmission Control Protocol (TCP) is one of the main protocol of the internet.
                            It provides reliable, ordered, error checked delivery of data through streams between
                            applications running on hosts on IP network.
                        </p>
                        <br>
                        <p>
                            For further information about what each field found within a TCP Header, select one of the options below.
                        </p>
                        <br>
                            {% for dict_item in tcp_info %}
                                {{ loop.index }}
                                {% for key, value in dict_item.items() %}
                                    <button class="inner-accordion">{{ key | safe }}</button>
                                    <div class="inner-panel">
                                        {% if key == 'Source Port' %}
                                            <h3>What is the Source Port field?</h3>
                                            <p>
                                                The Source Port is the number that identifies the port where the packet information is sent from.
                                            </p>
                                            <br>
                                            <p>Packet's Source Port:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Dest. Port' %}
                                                <h3>What is the Destination Port field?</h3>
                                                <p>
                                                    The Destination Port is the number that identifies the port where the packet information is sent to.
                                                </p>
                                                <br>
                                                <p>Packet's Destination Port:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Sequence Number' %}
                                                <h3>What is the Sequence Number field?</h3>
                                                <p>
                                                    The Sequence Number indicates the position of the current packet's segment data
                                                    relative to the beginning of the TCP data stream.
                                                </p>
                                                <br>
                                                <p>Packet's Sequence Number:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Acknowledgment Number' %}
                                                <h3>What is the Acknowledgment Number</h3>
                                                <p>
                                                    The Acknowledgment Number is used to indicate the next sequence number that the sender is expecting.
                                                </p>
                                                <br>
                                                <p>Packet's Acknowledgment Number:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Reserve' %}
                                                <h3>What is the Reserve field?</h3>
                                                <p>
                                                    For future use and should be set to zero.
                                                </p>
                                                <br>
                                                <p>Packet's Reserve:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Flags' %}
                                                <h3>What are the Flag fields?</h3>
                                                <p>
                                                    The Flag fields are 'control' bits use to indicate what type of connection states or information about
                                                    how the packet should be handled by the receiving system.
                                                    The flag values can be set to '1' meaning active and '0' meaning inactive.
                                                    <ul>
                                                        <li>CWR</li>
                                                        <li>ECN</li>
                                                        <li>URG - Indicates the Urgent pointer field contains significant information.</li>
                                                        <li>ACK - </li>
                                                        <li>PSH - The 'push' flag is used by TCP to allow a sending application to specify that the data must be pushed through immediately.</li>
                                                        <li>RST- Indicates if the TCP connection must be reset.</li>
                                                        <li>SYN - The 'synchronize' flag is set to signal that the synchronize sequence numbers should occur. </li>
                                                        <li>FIN - If this flag is set, this causes the TCP connection to terminate</li>
                                                    </ul>
                                                </p>
                                                <br>
                                                <p>Packet's Flags:  <strong>{{ value | safe }}</strong></p>


                                        {% elif key == 'Window Size' %}
                                                <h3>What is the Window field?</h3>
                                                <p>
                                                    The Window field indicates how many octets () of data can be received by the TCP buffer.
                                                    It is used to provide flow control for the packet.
                                                </p>
                                                <br>
                                                <p>Packet's Window:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Checksum' %}
                                                <h3>What is the Checksum field?</h3>
                                                <p>

                                                </p>
                                                <br>
                                                <p>Packet's Checksum:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Checksum Status' %}
                                                <h3>What is the ...</h3>
                                                <p>A ... is...</p>
                                                <br>
                                                <p>Packet's ...:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% elif key == 'Urgent Pointer' %}
                                                <h3>What is the Urgent Pointer field?</h3>
                                                <p>
                                                    The Urgent Pointer specifies the offset of urgent data in the message, relative to the
			                                        Sequence number in the header. This field is only valid if URG Flag is set.
                                                </p>
                                                <br>
                                                <p>Packet's Urgent Pointer:  <strong>{{ value | safe }}</strong></p>
                                                <br>

                                        {% else %}
                                            <p>{{ key | safe }}:  <strong>{{ value | safe }}</strong></p>
                                            <br>
                                        {% endif %}
                                    </div>
                                {% endfor %}
                                <br>
                            {% endfor %}
                        </div>
                    {% endif %} <!-- end TCP -->

                    {% if udp_info != [] %}
                        <!--        UDP ACCORDION BUTTON         -->
                        <button class="accordion">Captured UDP Header Information</button>
                        <div class="panel">
                        <br>
                        <h4>UDP Information</h4>
                        <hr>
                        <p>
                           The User Datagram Protocl (UDP) uses a simple connectionless transmission model. Provides checksum for data integrity, port numbers
                            for addressing diff function at source + dest of datagram. Communication is achieved by transmitting info in one
                            direction from source to destination without verifying readiness or state of receiver
                        </p>
                        <br>
                        <p>
                            For further information about what each field found within a UDP Header, select one of the options below.
                        </p>
                        <br>
                            {% for dict_item in udp_info %}
                                    {{ loop.index }}
                                    {% for key, value in dict_item.items() %}
                                        <button class="inner-accordion">{{ key | safe }}</button>
                                        <div class="inner-panel">
                                        {% if key == 'Source Port' %}
                                            <h3>What is the Source Port field?</h3>
                                            <p>
                                                The Source Port identifies the senders port when meaningful, assumed to be reply port as well if needed.
                                                If the port is not in used, then it is set to '0'.
                                            </p>
                                            <br>
                                            <p>Packet's Source Port:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Dest. Port' %}
                                            <h3>What is the Destination Port field?</h3>
                                            <p>
                                                The Destination Port identifies the receivers port of the packet and is a required field.
                                            </p>
                                            <br>
                                            <p>Packet's Destination Port:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Length' %}
                                            <h3>What is the Length field?</h3>
                                            <p>
                                                The Length field is length of the UDP Header and UDP data in bytes.
                                            </p>
                                            <br>
                                            <p>Packet's Length:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Checksum' %}
                                            <h3>What is the Checksum field?</h3>
                                            <p>
                                                The Checksum is used as an error-detection mechanism. The machine that sends the packet
                                                runs a mathematical algorithm on the datagram. The destination machine then runs the same
                                                algorithm on the datagram and if the values match then the datagram wasn't damaged on its journey.
                                            </p>
                                            <br>
                                            <p>Packet's Checksum:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Checksum Status' %}
                                            <h3>What is the ...</h3>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% elif key == 'Protocol' %}
                                            <h3>What is the </h3>
                                            <p>A ... is...</p>
                                            <br>
                                            <p>Packet's ...:  <strong>{{ value | safe }}</strong></p>
                                            <br>

                                        {% else %}
                                            <p> data error</p>
                                        {% endif %}
                                        </div>
                                    {% endfor %}
                                    <br>
                                {% endfor %}
                        </div><!-- inner panel -->
                    {% endif %}
                </div><!-- panel-->
            </div><!-- col-lg-6 -->
        </div><!-- row -->
        <br>
    </div><!-- container -->
</main> <!-- cd-main-content -->
{% include 'footer.html' %}

{% include 'js-static.html' %}
</body>
</html>


<script>
    var acc = document.getElementsByClassName("accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function(){
        /* Toggle between adding and removing the "active" class,
        to highlight the button that controls the panel */
        this.classList.toggle("active");

        /* Toggle between hiding and showing the active panel */
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
}
</script>

<script>
    var acc = document.getElementsByClassName("inner-accordion");
var i;

for (i = 0; i < acc.length; i++) {
    acc[i].onclick = function(){
        /* Toggle between adding and removing the "active" class,
        to highlight the button that controls the panel */
        this.classList.toggle("active");

        /* Toggle between hiding and showing the active panel */
        var panel = this.nextElementSibling;
        if (panel.style.display === "block") {
            panel.style.display = "none";
        } else {
            panel.style.display = "block";
        }
    }
}
</script>


<script>

    function download() {
        alert("BS");
        var jsString = $('pandas_web_base');

        $.ajax({
            url: '/analysishub/',
            data:jsString,
            success: function (data) {
                var FileSaver = require('file-saver');
                var blob = new Blob([data], {type: "text/plain;charset=utf-8"});
                FileSaver.saveAs(blob, data)

            }
        })
    }


</script>

<!--
<script>
$(document).ready(function () {
        $.ajax({
            url: '/interfaces',
            type: 'POST',
            data: 'pandas_web',
            success: function (response) {
            alert('Packet Analysis beginning');
            console.log(pandas_web);
            },
            error: function (error) {
                console.log(error);
            }
        });
    });
</script>
-->